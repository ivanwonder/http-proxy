<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Hello World!</title>
  </head>
  <body>
    <ul>
      <li>port : <input id="port"></li>
      <li>proxy port : <input id="proxy_port"></li>
      <li>youtube proxy port : <input id="youtube_proxy_port"></li>
      <input type="button" value="create proxy server" id="createServer">
      <p id="error" style="color: red; display:none"></p>
    </ul>
    <script>
      document.getElementById('createServer').addEventListener('click', function () {
        const fork = require('child_process').fork;
        const ls = fork('./openProxy.js');

        require('electron').ipcRenderer.on('closels', (event, message) => {
          console.log(message)  // Prints 'whoooooooh!'
        })

        ls.on('close', (code) => {
          console.log(`child process exited with code ${code}`);
        });

        ls.on('error', function (e) {
          console.log('error: ' + e)
        })

        ls.on('message', function (message) {
          let err = document.getElementById('error')
          if (message.error) {
            err.innerHTML = message.error
            err.style.display = ''
          }

          if (message.success) {
            err.style.display = 'none'
          }
        })

        ls.send({ open: {
          port: document.getElementById('port').value || 9393,
          proxyPort: document.getElementById('proxy_port').value || 1080,
          youtubeProxyPort: document.getElementById('youtube_proxy_port').value || 1080
        } });
      })
    </script>
  </body>
</html>